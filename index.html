<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RCTQ - Diagnostic Mode</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>body{background-color:#0f172a;color:#e2e8f0;font-family:sans-serif}</style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // PASTE YOUR NEW KEY HERE
        const API_KEY = "AIzaSyDxqVXeJFLeesdXqPAuqY_cp9LVGV9c3-E"; 

        function App() {
            const [status, setStatus] = useState("Click button to diagnose...");
            const [details, setDetails] = useState("");

            const runDiagnosis = async () => {
                setStatus("Contacting Google...");
                const cleanKey = API_KEY.trim();
                
                try {
                    // 1. Ask Google: "What models does this key have access to?"
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models?key=${cleanKey}`);
                    const data = await response.json();

                    if (data.error) {
                        setStatus("DIAGNOSIS: KEY REJECTED");
                        setDetails(JSON.stringify(data.error, null, 2));
                    } else if (data.models) {
                        // Filter for models that can generate content
                        const usable = data.models.filter(m => m.supportedGenerationMethods.includes("generateContent"));
                        const names = usable.map(m => m.name);
                        
                        setStatus("DIAGNOSIS: SUCCESS (Models Found)");
                        setDetails("Your key is VALID. You have access to:\n\n" + names.join("\n"));
                    } else {
                        setStatus("DIAGNOSIS: PROJECT EMPTY");
                        setDetails("The key is valid, but the project has NO models enabled. You must create a NEW PROJECT in Google Console.");
                    }
                } catch (e) {
                    setStatus("DIAGNOSIS: NETWORK ERROR");
                    setDetails(e.message + "\n\n(Check if 'Application Restrictions' are set to None in Google Console)");
                }
            };

            return (
                <div className="min-h-screen flex flex-col items-center justify-center p-8 text-center">
                    <h1 className="text-3xl font-bold text-white mb-4">RCTQ Diagnostic Tool</h1>
                    <p className="mb-8 text-slate-400">This will verify if your API Key is actually working.</p>
                    
                    <button onClick={runDiagnosis} className="bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-3 px-8 rounded-full mb-8 transition">
                        RUN DIAGNOSIS
                    </button>

                    <div className="bg-slate-900 border border-slate-700 p-6 rounded-xl w-full max-w-2xl text-left overflow-auto h-64 font-mono text-sm">
                        <div className="font-bold text-emerald-400 mb-2">{status}</div>
                        <pre className="text-slate-300 whitespace-pre-wrap">{details}</pre>
                    </div>
                    
                    <div className="mt-8 text-xs text-slate-500">
                        Current Key: {API_KEY.substring(0, 10)}...
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
